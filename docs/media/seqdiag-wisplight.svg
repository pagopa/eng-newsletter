<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1458px" preserveAspectRatio="none" style="width:1117px;height:1458px;" version="1.1" viewBox="0 0 1117 1458" width="1117px" zoomAndPan="magnify"><defs><filter height="300%" id="f1x0n2ua3i66ln" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#f1x0n2ua3i66ln)" height="75.9316" style="stroke:#000000;stroke-width:2.0;" width="621" x="389" y="1292.7051"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="147" x2="147" y1="40.4883" y2="1414.9473"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="443" x2="443" y1="40.4883" y2="1414.9473"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="965" x2="965" y1="40.4883" y2="1414.9473"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1058" x2="1058" y1="40.4883" y2="1414.9473"/><rect fill="#FEFECE" filter="url(#f1x0n2ua3i66ln)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="80" x="105" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="66" x="112" y="25.5352">WEB/User</text><rect fill="#FEFECE" filter="url(#f1x0n2ua3i66ln)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="80" x="105" y="1413.9473"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="66" x="112" y="1434.4824">WEB/User</text><rect fill="#FEFECE" filter="url(#f1x0n2ua3i66ln)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="84" x="399" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="70" x="406" y="25.5352">WISP Light</text><rect fill="#FEFECE" filter="url(#f1x0n2ua3i66ln)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="84" x="399" y="1413.9473"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="70" x="406" y="1434.4824">WISP Light</text><rect fill="#FEFECE" filter="url(#f1x0n2ua3i66ln)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="66" x="930" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="52" x="937" y="25.5352">pp-rest</text><rect fill="#FEFECE" filter="url(#f1x0n2ua3i66ln)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="66" x="930" y="1413.9473"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="52" x="937" y="1434.4824">pp-rest</text><rect fill="#FEFECE" filter="url(#f1x0n2ua3i66ln)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="93" x="1010" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="79" x="1017" y="25.5352">pp-logging</text><rect fill="#FEFECE" filter="url(#f1x0n2ua3i66ln)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="93" x="1010" y="1413.9473"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="79" x="1017" y="1434.4824">pp-logging</text><polygon fill="#A80036" points="431,67.7988,441,71.7988,431,75.7988,435,71.7988" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="147" x2="437" y1="71.7988" y2="71.7988"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="154" y="67.0566">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="167" y="67.0566">redirect to wallet/enterEmail?</text><path d="M70,84.7988 L70,109.7988 L219,109.7988 L219,94.7988 L209,84.7988 L70,84.7988 " fill="#FBFB77" filter="url(#f1x0n2ua3i66ln)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M209,84.7988 L209,94.7988 L219,94.7988 L209,84.7988 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="128" x="76" y="102.3672">paymentId in cookie</text><polygon fill="#A80036" points="431,136.4199,441,140.4199,431,144.4199,435,140.4199" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="147" x2="437" y1="140.4199" y2="140.4199"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="154" y="135.6777">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="259" x="167" y="135.6777">wallet/startSession?email=&lt;USER_MAIL&gt;</text><path d="M44,153.4199 L44,178.4199 L246,178.4199 L246,163.4199 L236,153.4199 L44,153.4199 " fill="#FBFB77" filter="url(#f1x0n2ua3i66ln)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M236,153.4199 L236,163.4199 L246,163.4199 L236,153.4199 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="181" x="50" y="170.9883">inserimento email in session</text><polygon fill="#A80036" points="953,205.041,963,209.041,953,213.041,957,209.041" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="443" x2="959" y1="209.041" y2="209.041"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="450" y="204.2988">3</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="35" x="463" y="204.2988">POST</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="294" x="502" y="204.2988">users/actions/start-session{email, idPayment}</text><polygon fill="#A80036" points="454,234.3516,444,238.3516,454,242.3516,450,238.3516" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="448" x2="964" y1="238.3516" y2="238.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="460" y="233.6094">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="197" x="473" y="233.6094">OK {sessionToken,sessionUser}</text><polygon fill="#A80036" points="953,263.6621,963,267.6621,953,271.6621,957,267.6621" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="443" x2="959" y1="267.6621" y2="267.6621"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="450" y="262.9199">5</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="463" y="262.9199">GET</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="145" x="494" y="262.9199">resources?language=IT</text><path d="M322,280.6621 L322,305.6621 L560,305.6621 L560,290.6621 L550,280.6621 L322,280.6621 " fill="#FBFB77" filter="url(#f1x0n2ua3i66ln)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M550,280.6621 L550,290.6621 L560,290.6621 L550,280.6621 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="217" x="328" y="298.2305">Recupero dei Terms and Condition</text><polygon fill="#A80036" points="454,332.2832,444,336.2832,454,340.2832,450,336.2832" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="448" x2="964" y1="336.2832" y2="336.2832"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="460" y="331.541">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="18" x="473" y="331.541">OK</text><polygon fill="#A80036" points="953,361.5938,963,365.5938,953,369.5938,957,365.5938" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="443" x2="959" y1="365.5938" y2="365.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="450" y="360.8516">7</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="35" x="463" y="360.8516">POST</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="292" x="502" y="360.8516">/users/actions/approve-terms{terms, privacy}</text><polygon fill="#A80036" points="1046.5,390.9043,1056.5,394.9043,1046.5,398.9043,1050.5,394.9043" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="443" x2="1052.5" y1="394.9043" y2="394.9043"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="450" y="390.1621">8</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="463" y="390.1621">PUT</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="223" x="494" y="390.1621">db-logging/logging/db/save event</text><path d="M311,407.9043 L311,432.9043 L570,432.9043 L570,417.9043 L560,407.9043 L311,407.9043 " fill="#FBFB77" filter="url(#f1x0n2ua3i66ln)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M560,407.9043 L560,417.9043 L570,417.9043 L560,407.9043 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="238" x="317" y="425.4727">Approvazione dei Term and Condition</text><polygon fill="#A80036" points="454,459.5254,444,463.5254,454,467.5254,450,463.5254" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="448" x2="964" y1="463.5254" y2="463.5254"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="460" y="458.7832">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="18" x="473" y="458.7832">OK</text><polygon fill="#A80036" points="431,488.8359,441,492.8359,431,496.8359,435,492.8359" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="147" x2="437" y1="492.8359" y2="492.8359"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="154" y="488.0938">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="67" x="176" y="488.0938">wallet/ccG</text><path d="M19,505.8359 L19,576.8359 L270,576.8359 L270,515.8359 L260,505.8359 L19,505.8359 " fill="#FBFB77" filter="url(#f1x0n2ua3i66ln)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M260,505.8359 L260,515.8359 L270,515.8359 L260,505.8359 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="203" x="25" y="523.4043">Dopo inserimento dei dati carta.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="213" x="25" y="538.7148">al "Continua" viene invocata "ccG"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="230" x="25" y="554.0254">salvataggio wallet POST wallet {id....}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="220" x="25" y="569.3359">recupero lista psp GET psps + filtri</text><polygon fill="#A80036" points="953,603.3887,963,607.3887,953,611.3887,957,607.3887" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="443" x2="959" y1="607.3887" y2="607.3887"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="450" y="602.6465">11</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="35" x="472" y="602.6465">POST</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="89" x="511" y="602.6465">/wallet(wallet)</text><path d="M340,620.3887 L340,905.3887 L541,905.3887 L541,630.3887 L531,620.3887 L340,620.3887 " fill="#FBFB77" filter="url(#f1x0n2ua3i66ln)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M531,620.3887 L531,630.3887 L541,630.3887 L531,620.3887 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="346" y="637.957">WalletType type</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="346" y="653.2676">Boolean favourite</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="136" x="346" y="668.5781">CreditCard creditCard</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="124" x="346" y="683.8887">Card bancomatCard</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="108" x="346" y="699.1992">Satispay satispay</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="61" x="346" y="714.5098">BPay bPay</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="49" x="346" y="729.8203">Psp psp</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="69" x="346" y="745.1309">Long idPsp</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="346" y="760.4414">Boolean pspEditable</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="94" x="346" y="775.752">Date lastUsage</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="170" x="346" y="791.0625">String idPagamentoFromEC</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="139" x="346" y="806.373">Boolean isMatchedPsp</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="179" x="346" y="821.6836">String jiffyCellphoneNumber</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="346" y="836.9941">List&lt;Psp&gt; pspListNotOnUsp</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="346" y="852.3047">Long idBuyerBank</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="142" x="346" y="867.6152">String buyerBankName</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="164" x="346" y="882.9258">String onboardingChannel</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="149" x="346" y="898.2363">Set&lt;Services&gt; services;</text><polygon fill="#A80036" points="454,932.2891,444,936.2891,454,940.2891,450,936.2891" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="448" x2="964" y1="936.2891" y2="936.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="460" y="931.5469">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="18" x="482" y="931.5469">OK</text><line style="stroke:#A80036;stroke-width:1.0;" x1="443" x2="485" y1="965.5996" y2="965.5996"/><line style="stroke:#A80036;stroke-width:1.0;" x1="485" x2="485" y1="965.5996" y2="978.5996"/><line style="stroke:#A80036;stroke-width:1.0;" x1="444" x2="485" y1="978.5996" y2="978.5996"/><polygon fill="#A80036" points="454,974.5996,444,978.5996,454,982.5996,450,978.5996" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="450" y="960.8574">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="231" x="472" y="960.8574">Pagina di riepilogo (wallet/summary)</text><polygon fill="#A80036" points="431,1003.9102,441,1007.9102,431,1011.9102,435,1007.9102" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="147" x2="437" y1="1007.9102" y2="1007.9102"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="154" y="1003.168">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="157" x="176" y="1003.168">"Conferma il pagamento"</text><path d="M46,1020.9102 L46,1045.9102 L243,1045.9102 L243,1030.9102 L233,1020.9102 L46,1020.9102 " fill="#FBFB77" filter="url(#f1x0n2ua3i66ln)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M233,1020.9102 L233,1030.9102 L243,1030.9102 L233,1020.9102 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="176" x="52" y="1038.4785">viene invocata l'action "pay"</text><polygon fill="#A80036" points="953,1072.5313,963,1076.5313,953,1080.5313,957,1076.5313" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="443" x2="959" y1="1076.5313" y2="1076.5313"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="450" y="1071.7891">15</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="35" x="472" y="1071.7891">POST</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="437" x="511" y="1071.7891">/payments/{idPayment}/actions/pay?language?it {idWallet,idPayment}</text><polygon fill="#A80036" points="454,1101.8418,444,1105.8418,454,1109.8418,450,1105.8418" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="448" x2="964" y1="1105.8418" y2="1105.8418"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="460" y="1101.0996">16</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="123" x="482" y="1101.0996">OK (datiPagamento)</text><polygon fill="#A80036" points="1046.5,1131.1523,1056.5,1135.1523,1046.5,1139.1523,1050.5,1135.1523" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="443" x2="1052.5" y1="1135.1523" y2="1135.1523"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="450" y="1130.4102">17</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="472" y="1130.4102">PUT</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="223" x="503" y="1130.4102">db-logging/logging/db/save event</text><polygon fill="#A80036" points="158,1160.4629,148,1164.4629,158,1168.4629,154,1164.4629" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="152" x2="442" y1="1164.4629" y2="1164.4629"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="164" y="1159.7207">18</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="101" x="186" y="1159.7207">UrlCheckout3ds</text><path d="M5,1177.4629 L5,1217.4629 L285,1217.4629 L285,1187.4629 L275,1177.4629 L5,1177.4629 " fill="#FBFB77" filter="url(#f1x0n2ua3i66ln)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M275,1177.4629 L275,1187.4629 L285,1187.4629 L275,1177.4629 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="235" x="11" y="1195.0313">/wallet/resume?MD=MjI=&amp;PaRes=OK</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="259" x="11" y="1210.3418">senza 3DS sia diretti alla view "checkout"</text><polygon fill="#A80036" points="431,1244.3945,441,1248.3945,431,1252.3945,435,1248.3945" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="147" x2="437" y1="1248.3945" y2="1248.3945"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="154" y="1243.6523">19</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="47" x="176" y="1243.6523">OK 3DS</text><polygon fill="#A80036" points="953,1273.7051,963,1277.7051,953,1281.7051,957,1277.7051" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="443" x2="959" y1="1277.7051" y2="1277.7051"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="450" y="1272.9629">20</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="82" x="472" y="1272.9629">POST resume</text><path d="M389,1292.7051 L463,1292.7051 L463,1299.7051 L453,1309.7051 L389,1309.7051 L389,1292.7051 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="75.9316" style="stroke:#000000;stroke-width:2.0;" width="621" x="389" y="1292.7051"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="29" x="404" y="1306.2734">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="175" x="478" y="1305.3398">[TRANSACTION_RESULT_VIEW]</text><polygon fill="#A80036" points="953,1327.3262,963,1331.3262,953,1335.3262,957,1331.3262" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="443" x2="959" y1="1331.3262" y2="1331.3262"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="450" y="1326.584">21</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="472" y="1326.584">GET</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="238" x="503" y="1326.584">payments/{idPayment}/actions/check</text><polygon fill="#A80036" points="454,1356.6367,444,1360.6367,454,1364.6367,450,1360.6367" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="448" x2="964" y1="1360.6367" y2="1360.6367"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="460" y="1355.8945">22</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="18" x="482" y="1355.8945">Ok</text><polygon fill="#A80036" points="158,1392.9473,148,1396.9473,158,1400.9473,154,1396.9473" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="152" x2="442" y1="1396.9473" y2="1396.9473"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="164" y="1392.2051">23</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="114" x="186" y="1392.2051">transaction_result</text><!--MD5=[33aa3d5d63da01b9a13c1962b4021361]
@startuml docs/media/seqdiag-wisplight

autonumber 
participant web as "WEB/User"
participant wl as "WISP Light"
participant api as "pp-rest"
participant logging as "pp-logging"


web -> wl : redirect to wallet/enterEmail?
note over web: paymentId in cookie

web -> wl : wallet/startSession?email=<USER_MAIL>
note over web: inserimento email in session

wl -> api : **POST** users/actions/start-session{email, idPayment}
api -> wl : OK {sessionToken,sessionUser}

wl -> api : **GET** resources?language=IT 
note over wl: Recupero dei Terms and Condition

api -> wl : OK

wl -> api : **POST** /users/actions/approve-terms{terms, privacy}

wl -> logging : **PUT** db-logging/logging/db/save event

note over wl: Approvazione dei Term and Condition

api -> wl : OK

web -> wl : wallet/ccG 

note over web: Dopo inserimento dei dati carta.\nal "Continua" viene invocata "ccG"\nsalvataggio wallet POST wallet {id....}\nrecupero lista psp GET psps + filtri

wl -> api : **POST** /wallet(wallet) 
note over wl:WalletType type\nBoolean favourite\nCreditCard creditCard\nCard bancomatCard\nSatispay satispay\nBPay bPay\nPsp psp\nLong idPsp\nBoolean pspEditable\nDate lastUsage\nString idPagamentoFromEC\nBoolean isMatchedPsp\nString jiffyCellphoneNumber\nList<Psp> pspListNotOnUsp\nLong idBuyerBank\nString buyerBankName\nString onboardingChannel\nSet<Services> services;

api -> wl : OK

wl -> wl : Pagina di riepilogo (wallet/summary)

web -> wl :"Conferma il pagamento" 
note over web: viene invocata l'action "pay"

wl -> api : **POST** /payments/{idPayment}/actions/pay?language?it {idWallet,idPayment}


api -> wl : OK (datiPagamento)

wl -> logging : **PUT** db-logging/logging/db/save event

wl -> web : UrlCheckout3ds 
note over web: /wallet/resume?MD=MjI=&PaRes=OK\nsenza 3DS sia diretti alla view "checkout"

web -> wl: OK 3DS

wl -> api : POST resume

loop TRANSACTION_RESULT_VIEW
wl -> api : **GET** payments/{idPayment}/actions/check

api -> wl : Ok 
end

wl -> web : transaction_result

@enduml 

PlantUML version 1.2020.26(Mon Dec 21 18:45:07 CET 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: GB
--></g></svg>